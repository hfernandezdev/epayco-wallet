{"openapi":"3.0.0","paths":{"/":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":""}},"tags":["App"]}},"/api/clients/register":{"post":{"description":"Crea un nuevo cliente en el sistema con la informaci√≥n proporcionada. Todos los campos son obligatorios.","operationId":"ClientController_createClient","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateClientDto"}}}},"responses":{"201":{"description":"Cliente registrado exitosamente","content":{"application/json":{"schema":{"example":{"success":true,"message":"Client registered successfully","data":{"clientId":"507f1f77bcf86cd799439011"}}}}}},"400":{"description":"Error en los datos proporcionados","content":{"application/json":{"schema":{"example":{"success":false,"message":"Client already exists","error":"CLIENT_ALREADY_EXISTS"}}}}},"500":{"description":"Error interno del servidor","content":{"application/json":{"schema":{"example":{"success":false,"message":"Internal server error","error":"INTERNAL_ERROR"}}}}}},"summary":"Registrar nuevo cliente","tags":["Clientes"]}},"/api/clients/find":{"post":{"description":"Busca un cliente por documento y celular. Ambos campos deben coincidir.","operationId":"ClientController_findClient","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FindClientDto"}}}},"responses":{"200":{"description":"Cliente encontrado","content":{"application/json":{"schema":{"example":{"success":true,"message":"Client found","data":{"document":"123456789","names":"Juan Carlos P√©rez","email":"juan@example.com","cellphone":"3001234567"}}}}}},"404":{"description":"Cliente no encontrado","content":{"application/json":{"schema":{"example":{"success":false,"message":"Client not found","error":"CLIENT_NOT_FOUND"}}}}}},"summary":"Buscar cliente","tags":["Clientes"]}},"/api/wallet/balance":{"post":{"description":"Obtiene el saldo actual de la billetera del cliente. Valida documento y celular.","operationId":"WalletController_getBalance","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetBalanceDto"}}}},"responses":{"200":{"description":"Saldo consultado exitosamente","content":{"application/json":{"schema":{"example":{"success":true,"message":"Balance retrieved successfully","data":{"balance":100}}}}}},"404":{"description":"Cliente no encontrado","content":{"application/json":{"schema":{"example":{"success":false,"message":"Client not found","error":"CLIENT_NOT_FOUND"}}}}}},"summary":"Consultar saldo","tags":["Billetera"]}},"/api/wallet/recharge":{"post":{"description":"Agrega saldo a la billetera del cliente. El cliente debe estar registrado previamente.","operationId":"WalletController_recharge","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RechargeDto"}}}},"responses":{"200":{"description":"Billetera recargada exitosamente","content":{"application/json":{"schema":{"example":{"success":true,"message":"Wallet recharged successfully","data":{"newBalance":150.5,"transactionId":"txn_abc123def456"}}}}}},"400":{"description":"Monto inv√°lido","content":{"application/json":{"schema":{"example":{"success":false,"message":"Invalid amount","error":"INVALID_AMOUNT"}}}}},"404":{"description":"Cliente no encontrado","content":{"application/json":{"schema":{"example":{"success":false,"message":"Client not found","error":"CLIENT_NOT_FOUND"}}}}}},"summary":"Recargar billetera","tags":["Billetera"]}},"/api/wallet/debit":{"post":{"description":"Debita saldo de la billetera del cliente para un pago. Requiere validaci√≥n por token.","operationId":"WalletController_debit","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DebitDto"}}}},"responses":{"200":{"description":"Billetera debitada exitosamente","content":{"application/json":{"schema":{"example":{"success":true,"message":"Wallet debited successfully","data":{"newBalance":80,"transactionId":"txn_xyz789ghi012"}}}}}},"400":{"description":"Fondos insuficientes o token inv√°lido","content":{"application/json":{"schema":{"example":{"success":false,"message":"Insufficient funds or invalid token","error":"INSUFFICIENT_FUNDS_OR_INVALID_TOKEN"}}}}},"404":{"description":"Cliente no encontrado","content":{"application/json":{"schema":{"example":{"success":false,"message":"Client not found","error":"CLIENT_NOT_FOUND"}}}}}},"summary":"Debitar billetera","tags":["Billetera"]}},"/api/payments/initiate":{"post":{"description":"Inicia un proceso de pago generando un token de 6 d√≠gitos que se env√≠a al email del cliente. Valida saldo suficiente y existencia del cliente.","operationId":"PaymentController_initiatePayment","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InitiatePaymentDto"}}}},"responses":{"200":{"description":"Proceso de pago iniciado, token enviado por email","content":{"application/json":{"schema":{"example":{"success":true,"message":"Confirmation token sent to your email","data":{"sessionId":"sess_k5j8d3h2m1n9p0q7","expiresIn":"15 minutes"}}}}}},"400":{"description":"Saldo insuficiente","content":{"application/json":{"schema":{"example":{"success":false,"message":"Insufficient balance. Current: $50.00, Required: $100.00","error":"INSUFFICIENT_FUNDS"}}}}},"404":{"description":"Cliente no encontrado","content":{"application/json":{"schema":{"example":{"success":false,"message":"Client not found","error":"CLIENT_NOT_FOUND"}}}}},"500":{"description":"Error al enviar el email","content":{"application/json":{"schema":{"example":{"success":false,"message":"Failed to send confirmation email","error":"EMAIL_SEND_FAILED"}}}}}},"summary":"Iniciar proceso de pago","tags":["Pagos"]}},"/api/payments/confirm":{"post":{"description":"Confirma un pago utilizando el token de 6 d√≠gitos recibido por email. Valida sesi√≥n y token antes de realizar el d√©bito.","operationId":"PaymentController_confirmPayment","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmPaymentDto"}}}},"responses":{"200":{"description":"Pago confirmado exitosamente","content":{"application/json":{"schema":{"example":{"success":true,"message":"Payment confirmed successfully","data":{"transactionId":"txn_pay987654321","newBalance":49.25,"amount":50.75}}}}}},"400":{"description":"Token inv√°lido","content":{"application/json":{"schema":{"example":{"success":false,"message":"Invalid token. Attempts remaining: 2","error":"INVALID_TOKEN"}}}}},"404":{"description":"Sesi√≥n no encontrada","content":{"application/json":{"schema":{"example":{"success":false,"message":"Invalid or expired session","error":"INVALID_SESSION"}}}}}},"summary":"Confirmar pago con token","tags":["Pagos"]}}},"info":{"title":"ePayco Wallet - Business Service API","description":"\n# üìã ePayco Wallet API\n\nEste es el servicio de negocio que act√∫a como intermediario entre el frontend React y el servicio de base de datos.\n\n## üîó Arquitectura\n- **Frontend** ‚Üí **Business Service** (este) ‚Üí **Database Service** ‚Üí **MongoDB**\n\n## üìä Flujo de Operaciones\n1. **Registro de Clientes** ‚Üí Crear nuevos usuarios del sistema\n2. **Recarga de Billetera** ‚Üí Agregar saldo a la cuenta\n3. **Proceso de Pagos** ‚Üí Iniciar y confirmar pagos con token\n4. **Consulta de Saldo** ‚Üí Verificar saldo disponible\n\n## üîê Seguridad\n- Validaci√≥n de datos con class-validator\n- Tokens de confirmaci√≥n de 6 d√≠gitos\n- Expiraci√≥n de sesiones (15 minutos)\n- L√≠mite de intentos (3 m√°ximo)\n\n## üìß Email\nLos tokens de confirmaci√≥n se env√≠an via Ethereal Email para testing.\n    ","version":"1.0","contact":{"name":"Equipo ePayco","url":"https://epayco.com","email":"soporte@epayco.com"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"}},"tags":[{"name":"Clientes","description":"Operaciones relacionadas con clientes"},{"name":"Billetera","description":"Operaciones de recarga y consulta de saldo"},{"name":"Pagos","description":"Proceso de pagos con confirmaci√≥n por token"}],"servers":[],"components":{"schemas":{"CreateClientDto":{"type":"object","properties":{"document":{"type":"string","description":"N√∫mero de documento de identidad del cliente","example":"123456789","minLength":5,"maxLength":20},"names":{"type":"string","description":"Nombres completos del cliente","example":"Juan Carlos P√©rez Garc√≠a","minLength":2,"maxLength":100},"email":{"type":"string","description":"Correo electr√≥nico del cliente","example":"juan.perez@example.com"},"cellphone":{"type":"string","description":"N√∫mero de celular del cliente","example":"3001234567","minLength":10,"maxLength":15}},"required":["document","names","email","cellphone"]},"FindClientDto":{"type":"object","properties":{"document":{"type":"string","description":"N√∫mero de documento del cliente","example":"123456789"},"cellphone":{"type":"string","description":"N√∫mero de celular del cliente","example":"3001234567"}},"required":["document","cellphone"]},"GetBalanceDto":{"type":"object","properties":{"document":{"type":"string","description":"Documento del cliente","example":"123456789"},"cellphone":{"type":"string","description":"Celular del cliente","example":"3001234567"}},"required":["document","cellphone"]},"RechargeDto":{"type":"object","properties":{"document":{"type":"string","description":"Documento del cliente","example":"123456789"},"cellphone":{"type":"string","description":"Celular del cliente","example":"3001234567"},"amount":{"type":"number","description":"Valor a recargar en la billetera","example":100.5,"minimum":1}},"required":["document","cellphone","amount"]},"DebitDto":{"type":"object","properties":{"document":{"type":"string","description":"Documento del cliente","example":"123456789"},"cellphone":{"type":"string","description":"N√∫mero de celular del cliente","example":"3001234567"},"amount":{"type":"number","description":"Monto del pago","example":50.75,"minimum":1}},"required":["document","cellphone","amount"]},"InitiatePaymentDto":{"type":"object","properties":{"document":{"type":"string","description":"Documento del cliente","example":"123456789"},"cellphone":{"type":"string","description":"Celular del cliente","example":"3001234567"},"amount":{"type":"number","description":"Monto del pago","example":50.75,"minimum":1},"email":{"type":"string","description":"Email donde se enviar√° el token de confirmaci√≥n","example":"cliente@example.com"},"description":{"type":"string","description":"Descripci√≥n opcional del pago","example":"Pago por servicios mensuales"}},"required":["document","cellphone","amount","email"]},"ConfirmPaymentDto":{"type":"object","properties":{"sessionId":{"type":"string","description":"ID de sesi√≥n generado al iniciar el pago","example":"sess_k5j8d3h2m1n9p0q7"},"token":{"type":"string","description":"Token de 6 d√≠gitos enviado al email","example":"123456","minLength":6,"maxLength":6}},"required":["sessionId","token"]}}}}